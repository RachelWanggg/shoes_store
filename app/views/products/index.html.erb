<h1>Welcome to Shoes Store</h1>
<%= form_with url: products_path, method: :get, local: true do |f| %>
  <%= f.text_field :q, value: params[:q], placeholder: "Search shoes..." %>
  <%= f.text_field :min_price, value: params[:min_price], placeholder: "Min price" %>
  <%= f.text_field :max_price, value: params[:max_price], placeholder: "Max price" %>
  <%= f.submit "Search" %>
<% end %>

<% if @products.any? %>
  <div class="products-grid">
    <% @products.each do |product| %>
      <div class="product-card">
        <%= link_to product_path(product) do %>
          <% if product.image.attached? %>
            <%= image_tag product.image, width: 300%>
          <% else %>
            <%= image_tag "placeholder.png", width: 300, height: 300 %>
          <% end %>
          <h3><%= product.name %></h3>
        <% end %>
        <p><%= number_to_currency(product.price_cents / 100.0) %></p>
        <%= button_to "Add to Cart", cart_items_path(product_id: product.id), method: :post %>
      </div>
    <% end %>
  </div>
<% else %>
  <p>No product found</p>
<% end %>

<% if user_signed_in? %>
  <p>Hello, <%= current_user.email %></p>
  <%= link_to 'My Cart', cart_path %> |
  <% if current_user.admin? %>
    <%= link_to 'Admin Products', admin_products_path %>
  <% else %>
    <%= link_to 'Products', products_path %>
  <% end %>
  <%= link_to 'Logout', destroy_user_session_path, data: { turbo_method: :delete } %>
<% else %>
  <%= link_to 'Sign In', new_user_session_path %> |
  <%= link_to 'Sign Up', new_user_registration_path %>
<% end %>